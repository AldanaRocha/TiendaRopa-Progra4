{% extends "base.html" %}
{% load widget_tweaks %}


{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Editar perfil</h2>

    <!-- Mensajes -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <div class="card shadow-sm p-4">
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Avatar preview -->
            <div class="text-center mb-4">
                {% if user.profile.avatar %}
                    <img id="avatarPreview" src="{{ user.profile.avatar.url }}" alt="Avatar" class="rounded-circle" width="120">
                {% else %}
                    <img id="avatarPreview" src="https://via.placeholder.com/120" alt="Avatar" class="rounded-circle">
                {% endif %}
            </div>

            <!-- Campos del formulario con espacio -->
            <div class="mb-3">
                {{ form.bio.label_tag }}
                {{ form.bio|add_class:"form-control" }}
                {% if form.bio.errors %}
                    <div class="text-danger">{{ form.bio.errors }}</div>
                {% endif %}
            </div>

            <div class="mb-3">
                {{ form.website.label_tag }}
                {{ form.website|add_class:"form-control" }}
                {% if form.website.errors %}
                    <div class="text-danger">{{ form.website.errors }}</div>
                {% endif %}
            </div>

            <div class="mb-3">
                {{ form.avatar.label_tag }}
                {{ form.avatar|add_class:"form-control" }}
                {% if form.avatar.errors %}
                    <div class="text-danger">{{ form.avatar.errors }}</div>
                {% endif %}
            </div>

            <div class="text-center">
                <button type="submit" class="btn btn-primary">Guardar</button>
                <button href="{% url 'home' %}" class="btn btn-primary">Salir</button>

            </div>
        </form>
    </div>
</div>

<!-- Script para avatar preview -->
<script>
    const avatarInput = document.getElementById('id_avatar');
    const avatarPreview = document.getElementById('avatarPreview');
    if (avatarInput) {
        avatarInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                avatarPreview.src = URL.createObjectURL(file);
            }
        });
    }
</script>
{% endblock %}

